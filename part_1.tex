
%%Программная реализация (на языке Javascript) алгоритмов
%% генерации фонда оценочных средств по математике
\section{Глава первая}
\subsection{Реализация алгоритмов на базе проекта Час ЕГЭ}
Как было уже сказано ранее, генерация заданий происходит при помощи шаблонов.
Программная реализация на языке JavaScript обеспечивает генерацию текстового задания,
графической на основе canvas
\footnote{HTML элемента, использующегося для рисования графики средствами языков программирования и алгоритма решения задачи} в случае необходимости,
ответа и иногда подробного решения.

Алгоритм написания простого шаблона~\cite{chasi} на основе номера 109083 Открытого Банка Заданий ЕГЭ~\cite{fipi}:
\begin{enumerate}
	\item Выбираем задание из Открытого Банка Заданий ЕГЭ и копируем его текст.
	\item Добавляем ответ в поле answers (по умолчанию 0).
	      \lstinputlisting{code/listing_1.1.js}
	\item Инициализируем всех необходимые переменные для задачи (вес, проценты и так далее).
	      Присваиваем им значения при помощи функции \hyperlink{sluchch}{sluchch()} или
	      \hyperlink{slKrome}{slKrome()} (см. главу \ref{2sect}). Для хранения ответа создаём отдельную переменную.
	      \lstinputlisting{code/listing_1.2.js}
	\item Заменяем все числа в тексте на переменные (при помощи +'\cdot'+).
	\item Обособляем слова, которые не влияют на условия задачи. Это могут быть
	      имена, профессии, транспорт и т.п.
	\item Создаём переменные, которые будет отвечать за выбранные в прошлом пункте
	      слова, и заменяем слова на переменные в тексте задачи.
	      Выбираем их значения из массивов при помощи \hyperlink{iz}{iz()} (см. главу \ref{2sect}).
	\item Иногда в задании выбранные слова используются в разных падежах.
	      Для этого в проекте существует лексический модуль.
	      Используем на склоняемых словах функцию \hyperlink{sklonlxkand}{sklonlxkand()}.
	      Теперь необходимо указать падеж слов в задании.
	      Также при необходимости заглавной буквы в слове используем
	      \hyperlink{toZagl}{toZagl()} (см. главу \ref{2sect}).
	\item Если в тексте задачи присутствуют слова, зависимые от числительных,
	      к ним применяется функция \hyperlink{chislitlx}{chislitlx()} (см. главу \ref{2sect}).
	      \lstinputlisting{code/listing_1.3.js}
\end{enumerate}

Но не все задачи решаются при помощи линейного алгоритма. Тогда в коде шаблона
используется слишком много циклов с постусловиями (или предусловиями)
Для таких случаев в проекте существует функция retryWhileUndefined(), которое
будет запускать программу до тех пор, пока случайные переменные не будут удовлетворять всем условиям.
Перезапуск осуществляется посредством постановки условий с последующим return.
Рассмотрим такой пример.

\textbf{Алгоритм написания шаблона с изображением графика прямой:}
\begin{enumerate}
	\item Для отображения рисунка необходимо вызвать функцию chas2.task.modifiers.
	      addCanvasIllustration(), которой передаются высота и ширина изображения и функция отрисовки.
	      \lstinputlisting{code/listing_2.1.js}
	\item Пусть наша прямая проходит через две точки $(x_1,y_1)$ и $(x_2,y_2)$. Инициализируем их координаты случайными целыми числами. Теперь через них выразим коэффициенты уравнения прямой $y=kx+b$.
	      Для дальнейшего вычисления точек прямой напишем вспомогательную функцию $f(x)$.
	      \lstinputlisting{code/listing_2.2.js}

	\item Для того, чтобы уравнения нашей прямой можно было восстановить по рисунку, необходимо и достаточно,
	      чтобы были видны две её точки. Для поиска таких точек используем функцию \hyperlink{intPoints}{intPoints()} (см. главу \ref{2sect}).
	      \lstinputlisting{code/listing_2.3.js}
	\item Приступим к изображению графика. Инициализируем переменную paint1 как функцию function(ct). Внутри неё зададим высоту и ширину графика в пикселях.
	      Изображаем координатную плоскость функцией \hyperlink{drawCoordPlane}{drawCoordPlane()} и сам график функцией
	      \hyperlink{graph9AdrawFunction}{graph9AdrawFunction()}. А также отметим две целые точки посредством \hyperlink{graph9AmarkCircles}{graph9AmarkCircles()} (см. главу \ref{2sect}).
	      \vspace{\baselineskip}

	      \lstinputlisting{code/listing_2.4.js}
\end{enumerate}

\textbf{Алгоритм написания шаблона с изображением графика производной:}

\begin{enumerate}
	\item Для отображения рисунка необходимо вызвать функцию chas2.task.modifiers.
	      addCanvasIllustration(), которой передаются высота и ширина изображения и функция отрисовки.\\
	      \\
	      \lstinputlisting{code/listing_3.1.js}
	\item Определяем область определения будущей функции и заполняем два массива, где будут находиться координаты точек, через которые будет проходить график функции.
	      Строим график по точкам при помощи библиотеки \texttt{cubic-spline}.
	      \lstinputlisting{code/listing_3.2.js}
	\item Находим экстремумы функции, промежутки её возрастания и убывания.
	      \lstinputlisting{code/listing_3.3.js}
	\item Отрисовываем график, определяем задание.
	      \lstinputlisting{code/listing_3.4.js}

\end{enumerate}

\subsection{Преимущества программной генерации заданий}
На примере двух предыдущих задач были явно показано превосходство шаблонов над заданиями из Открытого Банка Заданий, а именно:
\begin{enumerate}
	\item Большое количество разнообразных задач одного типа.
	\item Простота и скорость написания шаблонов.
	\item Невозможность нахождения учащимися ответов на задачи.
\end{enumerate}

